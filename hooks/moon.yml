# https://moonrepo.dev/docs/config/project
$schema: "https://moonrepo.dev/schemas/project.json"

language: python
type: tool

fileGroups:
  sources:
    - "*.py"

tasks:
  lint:
    command: "uv run ruff check ."
    deps:
      - "root:sync"
    inputs:
      - "@group(sources)"

  format:
    command: "uv run ruff format ."
    inputs:
      - "@group(sources)"
    local: true

  fix:
    command: "uv run ruff check --fix . && uv run ruff format ."
    inputs:
      - "@group(sources)"
    local: true

  install:
    command: "echo 'Installing Claude Code hooks...' && mkdir -p ~/.claude/hooks/sibyl && cp ./*.py ~/.claude/hooks/sibyl/ && chmod +x ~/.claude/hooks/sibyl/*.py && python3 configure.py && echo '✓ Hooks installed - restart Claude Code to activate'"
    local: true
    options:
      shell: true

  uninstall:
    command: "rm -rf ~/.claude/hooks/sibyl && echo '✓ Removed Sibyl hooks (settings.json unchanged - edit manually if needed)'"
    local: true
    options:
      shell: true
